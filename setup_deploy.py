#!/usr/bin/env python3
"""
–°–∫—Ä–∏–ø—Ç –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –æ–∫—Ä—É–∂–µ–Ω–∏—è –ø—Ä–∏ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–∏
"""

import os
import asyncio
from bot.database import Database
from bot.config import DATABASE_PATH

async def setup_deployment():
    """–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è"""
    print("üöÄ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è...")
    
    # –°–æ–∑–¥–∞–µ–º –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–∞–ø–∫–∏
    folders = ['data', 'static', 'static/uploads']
    for folder in folders:
        os.makedirs(folder, exist_ok=True)
        print(f"‚úÖ –°–æ–∑–¥–∞–Ω–∞ –ø–∞–ø–∫–∞: {folder}")
    
    # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
    print("üìä –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö...")
    db = Database(DATABASE_PATH)
    await db.init_db()
    print("‚úÖ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞")
    
    # –î–æ–±–∞–≤–ª—è–µ–º —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    print("üë§ –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è...")
    test_user = {
        'telegram_id': 999999999,
        'username': 'demo_user',
        'first_name': '–î–µ–º–æ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å',
        'current_step': 7  # –ó–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–π —Å—Ç–∞—Ç—É—Å –¥–ª—è 5 –≤–æ–ø—Ä–æ—Å–æ–≤
    }
    
    await db.create_or_update_user(test_user)
    
    # –¢–µ—Å—Ç–æ–≤—ã–µ –æ—Ç–≤–µ—Ç—ã
    test_answers = [
        {'question': '–ö–∞–∫–æ–π —É –≤–∞—Å –æ–ø—ã—Ç –≤ —Ä–∞–±–æ—Ç–µ?', 'answer': '–°—Ä–µ–¥–Ω–∏–π —É—Ä–æ–≤–µ–Ω—å'},
        {'question': '–ª—é–±–∏—à—å –æ–≥—Ä–æ–º–Ω—ã–π —Å–∏—Å—å–∫–∞?', 'answer': '–î–∞'},
        {'question': '–Ω–∏–∫–∏—Ç–∞ —Ç–æ—Å—Ç—ã–π?', 'answer': '–ù–µ—Ç'},
        {'question': '–ö–∞–∫–æ–π —É —Ç–µ–±—è –ª—é–±–∏–º—ã–π —è–∑—ã–∫ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è?', 'answer': 'Python'},
        {'question': '–°–∫–æ–ª—å–∫–æ —á–∞—Å–æ–≤ –≤ –¥–µ–Ω—å —Ç—ã —Ä–∞–±–æ—Ç–∞–µ—à—å?', 'answer': '6-8 —á–∞—Å–æ–≤'}
    ]
    
    await db.update_user_answers(999999999, test_answers)
    await db.update_user_text_input(999999999, "–≠—Ç–æ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏. –í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ!")
    
    # –î–æ–±–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏—è –≤ —á–∞—Ç
    await db.add_chat_message(999999999, "–ü—Ä–∏–≤–µ—Ç! –Ø –ø—Ä–æ—à–µ–ª –≤–µ—Å—å –æ–ø—Ä–æ—Å", False)
    await db.add_chat_message(999999999, "–°–ø–∞—Å–∏–±–æ –∑–∞ —É—á–∞—Å—Ç–∏–µ! –ú—ã —Å–≤—è–∂–µ–º—Å—è —Å –≤–∞–º–∏.", True)
    
    print("‚úÖ –¢–µ—Å—Ç–æ–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–±–∞–≤–ª–µ–Ω")
    print("\nüéâ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞!")
    print("üìã –î–∞–Ω–Ω—ã–µ –¥–ª—è –≤—Ö–æ–¥–∞:")
    print("   –õ–æ–≥–∏–Ω: botadmin")
    print("   –ü–∞—Ä–æ–ª—å: TgBot2026!")
    print("\n‚ö†Ô∏è  –ù–µ –∑–∞–±—É–¥—å—Ç–µ —Å–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å –ø–æ—Å–ª–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è!")

if __name__ == "__main__":
    asyncio.run(setup_deployment())